#! /bin/sh

. `dirname $0`/common
HOME=/etc/skel

mounted()
{
        if [ "`cat /proc/mounts |grep -e $PWD/$1 -c`" -ne "0" ]; then
                return 0
        else
                return 1
        fi
}

do_mounts()
{
	if ! mounted /opt32; then
		mount /lib/adobereader.squashfs /opt32
		cd /opt32
        	if ! mounted dev ; then mount --bind /dev dev ; fi
	        if ! mounted proc ; then mount -t proc proc proc ; fi
	        if ! mounted sys ; then mount -t sysfs none sys ; fi
	        if ! mounted etc ; then mount --bind /etc etc ; fi
	        if ! mounted var ; then mount --bind /var var ; fi
	        if ! mounted root ; then mount --bind /root root ; fi
	        if ! mounted share ; then mount --bind /usr/share share ; fi
		if ! mounted home ; then mount --bind /home home ; fi
		cd /
	fi
}

if ! pkg_initialized $PACKAGE; then
	pkg_set_init_flag $PACKAGE

	do_mounts
fi
